<!DOCTYPE html>
<html>
<body>
<script>
var intervalId = -1;

function createCORSRequest(method, url){
    var xhr = new XMLHttpRequest();
    if ("withCredentials" in xhr){
        xhr.open(method, url, true);
    } else if (typeof XDomainRequest != "undefined"){
        xhr = new XDomainRequest();
        xhr.open(method, url);
    } else {
        xhr = null;
    }
    return xhr;
}

function startCameraFetch() {
	console.log("Start fetch")
	intervalId = setInterval(fetchCamera, 1000);	
}

function stopCameraFetch() {
	console.log("Stop fetch")
	if (intervalId != -1) {
		clearInterval(intervalId);
	}	
}

function fetchCamera() {
	console.log("Image ...");
	//var myImage = document.querySelector('.camera_image');
	//myImage.src = "http://192.168.0.16:8080/camera";

    var request = createCORSRequest("get", "http://192.168.0.16:8080/echo");
    if (request) {
        request.onload = function(){
            //do something with request.responseText
            console.log("Response:" + request.responseText)
        };
        request.send();
    }
}
</script>
<button id="start_btn" type="button" onclick="fetchCamera()">Start</button>
<button id="stop_btn" type="button" onclick="stopCameraFetch()">Stop</button><p>
<img id="image" src="" class="camera_image"/>
</body>
</html>
